# name: test/sql/mortgage_table.test
# description: test mortgage_table extension
# group: [quack]

# Before we load the extension, this will fail
statement error
SELECT * FROM mortgage_table(100000.0, 240, 1.8, "FixedMensualities");
----
Catalog Error: Table Function with name mortgage_table does not exist!

# Require statement will ensure the extension is loaded from now on
require mortgage_table

# Test PMT scalar function
query I
SELECT PMT(0.018/12, 240, 100000.0);
----
-496.4660485877993

# Test mortgage_table table function
query IIII
SELECT * FROM mortgage_table(10000.0, 24, 1.85, "FixedMensualities");
----
1	424.6755145069779	409.38804382736544	15.287470679612454
2	424.6755145069779	410.0138945990249	14.661619907952968
3	424.6755145069779	410.64070213821657	14.034812368761322
4	424.6755145069779	411.2684679075959	13.407046599382
5	424.6755145069779	411.8971933720545	12.778321134923374
6	424.6755145069779	412.52687999872353	12.14863450825436
7	424.6755145069779	413.1575292569768	11.517985250001118
8	424.6755145069779	413.7891426184345	10.886371888543408
9	424.6755145069779	414.42172155696665	10.253792950011245
10	424.6755145069779	415.0552675486963	9.620246958281598
11	424.6755145069779	415.68978207200325	8.985732434974636
12	424.6755145069779	416.3252666075273	8.350247899450608
13	424.6755145069779	416.9617226381717	7.713791868806197
14	424.6755145069779	417.5991516491069	7.076362857871004
15	424.6755145069779	418.23755512777353	6.437959379204358
16	424.6755145069779	418.87693456388644	5.798579943091454
17	424.6755145069779	419.51729144943755	5.15822305754034
18	424.6755145069779	420.1586272786999	4.516887228277994
19	424.6755145069779	420.80094354823086	3.8745709587470287
20	424.6755145069779	421.44424175687556	3.2312727501023346
21	424.6755145069779	422.0885234057705	2.5869911012073885
22	424.6755145069779	422.73378999834716	1.9417245086307275
23	424.6755145069779	423.3800430403353	1.2954714666425957
24	424.6755145069779	424.0272840397665	0.6482304672113628
